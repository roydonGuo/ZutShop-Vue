"use strict";(self["webpackChunkzut_shop"]=self["webpackChunkzut_shop"]||[]).push([[674],{7242:function(t,e,s){s.d(e,{Z:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"number-container d-flex justify-content-center align-items-center"},[t._v(" 购买数量 "),e("button",{staticClass:"btn btn-light btn-sm",attrs:{type:"button"},on:{click:t.reduceCount}},[t._v(" - ")]),e("span",{staticClass:"number-box"},[t._v(t._s(t.count))]),e("button",{staticClass:"btn btn-light btn-sm",attrs:{type:"button"},on:{click:t.addCount}},[t._v(" + ")])])},o=[],c=s(7592),i={props:{cid:{required:!0,type:Number},count:{default:1,type:Number}},methods:{addCount(){var t={cid:this.cid,num:this.count+1};c.Z.$emit("share",t)},reduceCount(){if(this.count>1){var t={cid:this.cid,num:this.count-1};c.Z.$emit("share",t)}}}},r=i,n=s(1001),l=(0,n.Z)(r,a,o,!1,null,"90ca6d10",null),d=l.exports},674:function(t,e,s){s.r(e),s.d(e,{default:function(){return x}});var a=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{margin:"0 20%"}},[t._m(0),e("Operate",{attrs:{isFull:t.operateState,amt:t.amt,total:t.total,goodsSelected:t.goodsSelected},on:{isAll:t.allSelect}}),e("div",{staticClass:"box-card clearfix",staticStyle:{padding:"20px"}},t._l(t.cartData,(function(s){return e("Good",{key:s.cid,attrs:{cid:s.cid,goods_num:s.num,goods_image:s.goods.image,goods_title:s.goods.title,goods_price:s.goods.price,goods_state:s.state},on:{"state-changed":t.getNowState,"has-cart-delete":t.getNowCart}})})),1)],1)},o=[function(){var t=this,e=t._self._c;return e("h2",[e("i",{staticClass:"el-icon-shopping-cart-full"}),t._v("购物车")])}],c=s(7592),i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"goods-container"},[e("div",{staticClass:"thumb"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"custom-control-input",attrs:{type:"checkbox",id:"cb"+t.cid},domProps:{checked:t.goods_state},on:{change:t.stateChanged}}),e("label",{staticClass:"custom-control-label",attrs:{for:"cb"+t.cid}},[e("img",{attrs:{src:t.goods_image,alt:"..."}})])])]),e("div",{staticClass:"goods-info"},[e("h3",{staticClass:"goods-title"},[t._v(t._s(t.goods_title))]),e("div",{staticClass:"goods-info-bottom"},[e("span",{staticClass:"goods-price"},[t._v("单价：￥"+t._s(t.goods_price.toFixed(2)))]),e("Counter",{attrs:{count:t.goods_num,cid:t.cid}})],1)]),e("div",[e("el-popconfirm",{staticClass:"ml-5",attrs:{"confirm-button-text":"确定","cancel-button-text":"我再想想",icon:"el-icon-info","icon-color":"red",title:"您确定删除吗？"},on:{confirm:t.removeGood}},[e("el-button",{attrs:{slot:"reference",type:"info",size:"mini",circle:"",icon:"el-icon-delete"},slot:"reference"})],1)],1)])},r=[],n=s(7242),l={props:{cid:{required:!0,type:Number},goods_num:{default:1,type:Number},goods_image:{default:"",type:String},goods_title:{default:"",type:String},goods_price:{default:"",type:Number},goods_state:{default:!0,type:Boolean}},methods:{stateChanged(t){const e=t.target.checked;this.$emit("state-changed",{cid:this.cid,state:e})},removeGood(){const t=this.cid;this.request.delete("/cart/"+this.cid).then((e=>{e.data?(this.$message.success("删除成功"),this.$emit("has-cart-delete",{cid:t})):this.$message.error("删除失败")}))}},components:{Counter:n.Z}},d=l,u=s(1001),h=(0,u.Z)(d,i,r,!1,null,"17bd30b2",null),m=h.exports,p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"operate-container"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"custom-control-input",attrs:{type:"checkbox",id:"cbFull"},domProps:{checked:t.isFull},on:{change:t.selectAll}}),e("label",{staticClass:"custom-control-label",attrs:{for:"cbFull"}},[t._v("全选")])]),e("div",[e("span",[t._v("合计：")]),e("span",{staticClass:"total-price"},[t._v("￥"+t._s(t.amt.toFixed(2)))])]),0==t.total?e("button"):e("button",{staticClass:"btn-settle",attrs:{type:"button"},on:{click:t.purchase}},[t._v(" 结算("+t._s(t.total)+") ")])])},g=[],f=(s(7658),{props:{isFull:{type:Boolean,default:!0},amt:{type:Number,default:0},total:{type:Number,default:0},goodsSelected:{type:Array,default:[]}},created(){},mounted(){},methods:{async purchase(){this.$router.push({path:"/purchase",query:{goodsSelected:this.goodsSelected}})},selectAll(t){this.$emit("isAll",t.target.checked)}}}),b=f,_=(0,u.Z)(b,p,g,!1,null,"56530ab4",null),C=_.exports,v={name:"Cart",data(){return{user:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):null,cartData:[]}},components:{Good:m,Operate:C},created(){this.getUserCart(),c.Z.$on("share",(t=>{this.cartData.some((e=>{if(e.cid===t.cid)return e.num=t.num,!0}))}))},computed:{operateState(){return this.cartData.every((t=>t.state))},amt(){return this.cartData.filter((t=>t.state)).reduce(((t,e)=>t+e.goods.price*e.num),0)},goodsSelected(){return this.cartData.filter((t=>t.state))},total(){return this.cartData.filter((t=>t.state)).reduce(((t,e)=>t+e.num),0)}},methods:{async getUserCart(){await this.request.get("/cart/list",{params:{uid:this.user.uid}}).then((t=>{200===t.code?(t.data.forEach((t=>{t.state=!1})),this.cartData=t.data):this.$message.error("获取购物车失败")}))},getNowState(t){this.cartData.some((e=>{if(e.cid==t.cid)return e.state=t.state,!0}))},getNowCart(t){this.getUserCart()},allSelect(t){this.cartData.forEach((e=>{e.state=t}))}},updated(){}},y=v,S=(0,u.Z)(y,a,o,!1,null,"b7337d4c",null),x=S.exports},7592:function(t,e,s){var a=s(6369);e["Z"]=new a["default"]}}]);
//# sourceMappingURL=674.5c261f5a.js.map